<!DOCTYPE html>
<html lang="en">
  <head>
    {% block head %}
    <title>My Spotify Haiku</title>
    {% endblock %}
  </head>
  <body>
    <div id="content">
      <button id="start">Get started</button>

      <div id="main-content" style="display: none">
        <h2>{{ spotify.name }} by {{ spotify.artist }}</h2>
        <label for="lyrics">Paste in lyrics here:</label>
        <input type="text" id="lyrics" name="lyrics" /><br /><br />
        <button id="write">Write my haiku</button>
      </div>
    </div>
    <div id="footer">
      {% block footer %} Made with ❤️ by
      <a href="https://aleguy02.dev">Alejandro Villate</a>. {% endblock %}
    </div>

    <script>
      const startButton = document.getElementById('start');
      const mainContent = document.getElementById('main-content');
      const writeButton = document.getElementById('write');

      startButton.addEventListener('click', () => {
        startButton.style.display = 'none';
        mainContent.style.display = 'block';
      });

      writeButton.addEventListener('click', async () => {
        writeButton.disabled = true;
        try {
          const response = await fetch('/api/makehaiku', { method: 'POST' });
          if (!response.ok) {
            throw new Error(`Response status: ${response.status}`);
          }
          console.log(response);
        } catch (error) {
          console.error(error.message);
        } finally {
          writeButton.disabled = false;
        }
      });
    </script>
  </body>
</html>
